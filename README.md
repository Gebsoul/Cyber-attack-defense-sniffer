# Cyber-attack-defense-sniffer
Cyber-attack-defense ex1A
整体构建的思路如下：
创建 PyQt5 界面
首先，创建一个PyQt5的GUI界面，包括下拉框、文本框和按钮，用于选择协议过滤器和地址过滤器、启动和停止嗅探以及重置显示。界面的布局使用了水平和垂直的布局管理器。

创建网络嗅探器
我们创建了一个名为Sniffer的类，继承自‘QMainWindow’，这个类包含了初始化UI、捕获数据包、开始嗅探、停止嗅探和重置的方法。

数据包捕获
使用Scapy库，利用packet_callback处理捕获到的数据包。捕获到的数据包将被解析并显示在表格中，包括源IP、源端口、目标IP、目标端口和数据包长度。可以通过滚动条确保表格总是显示最新的数据包。

开始和停止嗅探
点击Start Sniffing按钮后，使用Scapy的sniff函数开始嗅探网络数据包，同时应用所选的过滤条件。Stop Sniffing按钮用于停止嗅探。通过这两个按钮，用户可以控制嗅探的开始和停止。
显示数据包详细信息和二进制数据
用户可以在表格中选择特定的数据包，然后点击它来查看详细信息和二进制数据。我们在GUI中使用两个文本框，一个用于显示详细信息，另一个用于显示数据包的Hexdump。每次查看数据包时，滚动条都会被设置到初始位置，以确保用户可以轻松查看整个数据包。

实现上述步骤，需要具体函数，下面对程序进行简要说明：
导入必要的库
os：用于执行系统命令以打开和关闭混杂模式；sys：用于处理命令行参数和退出应用；PyQt5：用于创建图形用户界面；scapy.all：Scapy 库，用于嗅探和处理网络数据包。
初始化 Sniffer 类
在 __init__ 构造函数中，接受一个参数 host_ip，表示主机的 IP 地址。
创建 GUI 窗口
设置窗口的标题、大小和布局。
创建 GUI 控件
创建应用协议过滤器（HTTP、FTP、SMTP 等）和地址过滤器（IP 地址、MAC 地址）的下拉框。创建按钮：启动嗅探、停止嗅探和重置数据。创建数据展示控件：包括一个数据包列表、文本详情和十六进制展示。
packet_callback 
处理每个捕获到的数据包，提取源 IP、源端口、目标 IP、目标端口和报文长度，然后将它们添加到 GUI 中的数据包列表。
start_sniffing 
通过调用系统命令以管理员权限打开混杂模式。配置过滤器字符串，用于过滤特定类型的数据包。建一个线程来执行数据包嗅探，使用 sniff 函数。启用/禁用相应的按钮。
sniff_thread 
在一个单独的线程中进行数据包嗅探，通过 sniff 函数捕获数据包，并使用 packet_callback 处理捕获的数据包。使用 stop_filter 参数来控制何时停止嗅探。
stop_sniffing
停止数据包嗅探，通过将 stop_sniffing_flag 设置为 True，并重新启用/禁用按钮。使用系统命令关闭混杂模式。
reset_table
重置 GUI 中的数据包列表和文本详情，以准备捕获新的数据包。
show_packet_detail 
当用户单击数据包列表中的项目时，显示数据包的详细信息和十六进制展示。
主函数
检查命令行参数是否提供主机 IP，如果没有则显示用法。创建 PyQt5 应用，实例化 Sniffer 类并显示 GUI。当 GUI 关闭时，退出应用。
